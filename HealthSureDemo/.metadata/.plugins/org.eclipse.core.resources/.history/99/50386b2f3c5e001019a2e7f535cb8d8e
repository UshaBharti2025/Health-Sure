<%@ page contentType="text/html" pageEncoding="UTF-8" %>
<%@ taglib prefix="f" uri="http://java.sun.com/jsf/core" %>
<%@ taglib prefix="h" uri="http://java.sun.com/jsf/html" %>

<f:view>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Search Recipient</title>
    <style>
        /* [Keep all your previous styles unchanged] */
        body {
            background-color: #f3f4f6;
            color: #1f2937;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .navbar {
            background-color: #1e3a8a;
            padding: 16px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            gap: 24px;
            margin-bottom: 40px;
        }

        .navbar h\:commandLink {
            color: white;
            font-size: 18px;
            font-weight: 600;
            text-decoration: none;
            transition: color 0.3s;
        }

        .navbar h\:commandLink:hover {
            color: #facc15;
        }

        .navbar .active {
            color: #facc15;
            font-weight: bold;
            text-decoration: underline;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background-color: white;
            padding: 32px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .heading {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 24px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .form-group select,
        .form-group input[type="text"] {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            outline: none;
        }

        .form-group input[type="text"]:focus,
        .form-group select:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.2);
        }

        .error-msg {
            color: red;
            font-size: 13px;
            margin-top: 4px;
        }

        .btn {
            background-color: #1e3a8a;
            color: white;
            font-weight: 600;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #172554;
        }

         .table-wrapper {
            max-width: 1000px;
            margin: 30px auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            color: #374151;
        }

        .data-table th,
        .data-table td {
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            text-align: left;
        }

        .data-table th {
            background-color: #f3f4f6;
            font-weight: 600;
        }
        
        .no-result {
            text-align: center;
            margin-top: 24px;
            color: red;
            font-weight: 600;
        }
    </style>
</head>

<body>

    <!-- NAVBAR -->
    <div class="navbar">
        <h:form><h:commandLink value="Dashboard" action="dashboard1" /></h:form>
        <h:form><h:commandLink value="Search" action="SearchRecipient1" styleClass="active" /></h:form>
        <h:form><h:commandLink value="Show" action="ShowRecipient1" /></h:form>
        <h:form><h:commandLink value="Update" action="UpdateRecipient1" /></h:form>
    </div>

    <!-- Main Content -->
    <div class="container">
        <div class="heading">Search Recipient</div>

        <!-- Updated Form with Dropdown -->
        <h:form prependId="false">
            <div class="form-group">
                <h:outputLabel for="searchType" value="Search By:" />
                <h:selectOneMenu id="searchType" value="#{recipientController.searchType}">
                    <f:selectItem itemValue="hid" itemLabel="Health ID" />
                    <f:selectItem itemValue="firstName" itemLabel="First Name" />
                    <f:selectItem itemValue="mobile" itemLabel="Mobile Number" />
                    <f:selectItem itemValue="createdAt" itemLabel="Created At" />
                </h:selectOneMenu>
            </div>

            <div class="form-group">
                <h:outputLabel for="searchValue" value="Enter Value:" />
                <h:inputText id="searchValue" value="#{recipientController.searchValue}" required="true" />
                <h:message for="searchValue" styleClass="error-msg" />
            </div>
            
            
            <!-- Conditional Radio Buttons -->
            <h:panelGroup rendered="#{recipientController.searchType eq 'firstName'}">
                <div class="form-group">
                    <h:outputLabel value="First Name Search Mode:" />
                    <br/>
                    <h:selectOneRadio value="#{recipientController.nameSearchMode}">
                        <f:selectItem itemValue="startsWith" itemLabel="Starts With" />
                        <f:selectItem itemValue="contains" itemLabel="Contains" />
                    </h:selectOneRadio>
                </div>
            </h:panelGroup>

            <h:commandButton value="Search Recipient" action="#{recipientController.search}" styleClass="btn" />
        </h:form>

        <!-- ▾▾▾  RESULT AREA  ▾▾▾ -->
<style>
    /* only new / overridden rules */
    .table-wrapper{
        max-width:1200px;margin:30px auto;
        background-color:#ffffff;padding:20px;
        border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.1);
        overflow-x:auto;
    }
    .data-table{width:100%;border-collapse:collapse;font-size:14px;color:#374151}
    .data-table th,.data-table td{padding:10px 12px;border:1px solid #d1d5db;text-align:left}

    /* header – light navy + white text */
    .data-table th{
        background:#3b5fbf;      /* light‑navy */
        color:#ffffff;font-weight:600;
    }
    /* rounded corners */
    .data-table th:first-child{border-top-left-radius:6px}
    .data-table th:last-child {border-top-right-radius:6px}

    /* clickable header style for sorting */
    .sortable-header{cursor:pointer;text-decoration:underline;color:#eef2ff}
    .sortable-header:hover{color:#ffd700}

    /* pagination buttons */
    .pagination{text-align:center;margin-top:20px}
    .pagination h\:commandButton{
        margin:0 8px;padding:8px 16px;
        background:#1e3a8a;color:#fff;border:none;border-radius:4px;font-weight:bold;cursor:pointer
    }
    .pagination h\:commandButton[disabled]{background:#94a3b8;cursor:not-allowed}
    .no-result{color:red;font-weight:600;text-align:center;margin-top:20px}
</style>

<!-- SINGLE‑ROW (panelGrid)  — leave as‑is if you still want single‑item view -->
<h:panelGrid columns="2" styleClass="result-grid"
             rendered="#{not empty recipientController.recipient}">
    ...
</h:panelGrid>

<!-- ===== LIST RESULT TABLE (with sorting + pagination) ===== -->
<div class="table-wrapper" >
    <h:panelGroup rendered="#{not empty recipientController.recipientList}">
        <!-- ► dataTable shows only 5 rows via controller’s getPaginatedList()  -->
        <h:dataTable value="#{recipientController.paginatedList}" var="rec"
                     styleClass="data-table">

            <!-- Health ID -->
            <h:column>
                <f:facet name="header">
                    <h:commandLink value="Health&nbsp;ID"
                                   action="#{recipientController.sortBy('hId')}"
                                   styleClass="sortable-header"/>
                </f:facet>
                <h:outputText value="#{rec.hId}" />
            </h:column>

            <!-- First Name -->
            <h:column>
                <f:facet name="header">
                    <h:commandLink value="First&nbsp;Name"
                                   action="#{recipientController.sortBy('firstName')}"
                                   styleClass="sortable-header"/>
                </f:facet>
                <h:outputText value="#{rec.firstName}" />
            </h:column>

            <!-- Last Name -->
            <h:column>
                <f:facet name="header">
                    <h:commandLink value="Last&nbsp;Name"
                                   action="#{recipientController.sortBy('lastName')}"
                                   styleClass="sortable-header"/>
                </f:facet>
                <h:outputText value="#{rec.lastName}" />
            </h:column>

            <!-- Mobile -->
            <h:column>
                <f:facet name="header">
                    <h:commandLink value="Mobile"
                                   action="#{recipientController.sortBy('mobile')}"
                                   styleClass="sortable-header"/>
                </f:facet>
                <h:outputText value="#{rec.mobile}" />
            </h:column>

            <!-- Email -->
            <h:column>
                <f:facet name="header">
                    <h:commandLink value="Email"
                                   action="#{recipientController.sortBy('email')}"
                                   styleClass="sortable-header"/>
                </f:facet>
                <h:outputText value="#{rec.email}" />
            </h:column>

            <!-- Created At -->
            <h:column>
                <f:facet name="header">
                    <h:commandLink value="Created&nbsp;At"
                                   action="#{recipientController.sortBy('createdAt')}"
                                   styleClass="sortable-header"/>
                </f:facet>
                <h:outputText value="#{rec.createdAt}" />
            </h:column>

        </h:dataTable>

        <!-- PAGINATION BUTTONS -->
        <div class="pagination">
            <h:commandButton value="Previous"
                             action="#{recipientController.previousPage}"
                             disabled="#{recipientController.previousButtonDisabled}" />
            <h:outputText value="Page #{recipientController.currentPage + 1}
                                 / #{recipientController.totalPages}" 
                          style="margin:0 10px;font-weight:600"/>
            <h:commandButton value="Next"
                             action="#{recipientController.nextPage}"
                             disabled="#{recipientController.nextButtonDisabled}" />
        </div>
    </h:panelGroup>

    <!-- Empty‑result message -->
    <h:outputText value="No recipient found with the given value."
                  rendered="#{empty recipientController.recipientList 
                              and not empty recipientController.searchValue}"
                  styleClass="no-result"/>
</div>
<!-- ▴▴▴  END RESULT AREA ▴▴▴ -->


</body>
</html>
</f:view>
